#! /usr/bin/env bash

source selfedit.sh

DOCKER_IMAGES_HOME=${VIQUEEN_DEVBOX_HOME}/docker-images

_image() {
    _with_arguments 2 $@
    name=${1}
    version=${2}
    echo "viqueen/${1}:${version}"
}

function build() {
    image=$(_image $@)
    target=${DOCKER_IMAGES_HOME}/${1}/
    sed "s/\${JDK_VERSION}/${2}/g" ${target}/jdk.Dockerfile > ${target}/Dockerfile

    shift
    shift

    docker build -t ${image} ${target}/ $@
}

function push() {
    image=$(_image $@)
    shift
    shift
    docker push ${image} $@
}

function run() {
    image=$(_image $@)
    docker run -it --entrypoint=/bin/bash ${image}
}

eval $@
