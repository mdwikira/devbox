#!/usr/bin/env bash

source atlassian-product.sh

DEFAULT_VERSION=6.15.6
SYNCHRONY_PORT=9091

function product_definition() {
    version=$(_default $1 ${DEFAULT_VERSION})
    echo "--product confluence
          --version ${version}
          --http-port 8080
          --server 127.0.0.1
          --ajp-port 8009"
}

function start() {
    run_with_jvm_args "-Xmx2048m -Dsynchrony.port=${SYNCHRONY_PORT}" $(product_definition $@)
}

function debug() {
    run_with_jvm_args "-Xmx2048m -Xdebug -Xrunjdwp:transport=dt_socket,address=5005,server=y,suspend=n -Dsynchrony.port=${SYNCHRONY_PORT}" $(product_definition $@)
}

function logs() {
  version=$(_default $1 ${DEFAULT_VERSION})
  tail_product_logs confluence ${version}
}

function view() {
  version=$(_default $1 ${DEFAULT_VERSION})
  view_product_logs confluence ${version}
}

function versions() {
  list_versions confluence
}

eval $@
